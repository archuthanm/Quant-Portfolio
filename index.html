<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loading...</title>

  <link rel="stylesheet" href="style.css">

  <style>

    body {
      background: #000;
      margin: 0;
      padding: 0;
      /* cursor: none;  <-- REMOVED (now in style.css) */
      overflow: hidden; 
    }

    #loader {
      position: fixed;
      inset: 0;
      background: #000;
      display: flex;
      flex-direction: column;
      z-index: 9999;
      
      padding: 40px;
      box-sizing: border-box;
      gap: 30px; 
    }

    .candles {
      display: block;
      position: relative;
      width: 100%; 
      flex-grow: 1;
      min-height: 300px;
      padding: 20px; 
      box-sizing: border-box; 
      border: 1px solid #444;
      background-color: #000;
      background-image: 
        repeating-linear-gradient(
          to right,
          #222 0,
          #222 1px,
          transparent 1px,
          transparent 40px
        ),
        repeating-linear-gradient(
          to bottom,
          #222 0,
          #222 1px,
          transparent 1px,
          transparent 40px
        );
      background-size: 40px 40px; 
    }

    .candle {
      width: 20px; 
      position: absolute; 
      transform-origin: bottom center;
      opacity: 0;
      transform: translateY(20px) scaleY(0.6);
      animation: appearRise forwards ease-out;
    }

    .green {
      background: #00ff87;
    }

    .red {
      background: #ff4f4f;
    }

    .candle::before {
      content: "";
      position: absolute;
      left: 50%;
      width: 2px;
      background: #bbb;
      top: 0;
      transform: translate(-50%, -100%); 
      height: var(--upper-wick, 20px);
    }

    .candle::after {
      content: "";
      position: absolute;
      left: 50%;
      width: 2px;
      background: #bbb;
      bottom: 0;
      transform: translate(-50%, 100%); 
      height: var(--lower-wick, 22px);
    }

    @keyframes appearRise {
      0%   { opacity: 0; transform: translateY(20px) scaleY(0.6); }
      60%  { opacity: 1; transform: translateY(-4px) scaleY(1.25); }
      100% { opacity: 1; transform: translateY(0) scaleY(1); }
    }

    .loader-bar-container {
      width: 100%; 
      height: 10px;
      background-color: #333;
      overflow: hidden; 
      flex-shrink: 0; 
      border-radius: 5px; 
    }

    .loader-bar-fill {
      height: 100%;
      width: 0%;
      background-color: #00ff87; 
      animation: fillBar 7.5s linear forwards; 
      border-radius: 5px;
    }

    @keyframes fillBar {
      from { width: 0%; }
      to   { width: 100%; }
    }

    /* #cursor { ... }  <-- REMOVED (now in style.css) */

  </style>

  <script>
    // 2. FIXED the redirect timer to match animation
    setTimeout(() => {
      window.location.href = "home.html";
    }, 7700); // 7.7s (was 8.5s)
  </script>

  <script>
    
    document.addEventListener("DOMContentLoaded", () => {
      
      function clamp(value, min, max) {
        return Math.max(min, Math.min(value, max));
      }

      const chart = document.querySelector('.candles'); 
      const chartWidth = chart.clientWidth;  
      const chartHeight = chart.clientHeight;
      
      const candleWidth = 20; 
      const candleGap = 18;   
      const unitSpace = candleWidth + candleGap;
      const numCandles = Math.floor(chartWidth / unitSpace);
      const totalAnimationTime = 7500;
      const delayPerCandle = (numCandles > 0) ? (totalAnimationTime / numCandles) : 0;
      
      let currentClosePriceY = 0;

      const candlePattern = [
        { type: 'green', height: 50,  upper: 15, lower: 10 },
        { type: 'green', height: 80,  upper: 10, lower: 10 },
        { type: 'red',   height: 40,  upper: 20, lower: 5  },
        { type: 'green', height: 100, upper: 10, lower: 25 },
        { type: 'green', height: 150, upper: 15, lower: 15 },
        { type: 'green', height: 180, upper: 25, lower: 10 },
        { type: 'red',   height: 100, upper: 10, lower: 20 },
        { type: 'red',   height: 120, upper: 15, lower: 15 },
        { type: 'red',   height: 160, upper: 20, lower: 5  },
        { type: 'green', height: 70,  upper: 5,  lower: 20 },
        { type: 'green', height: 90,  upper: 15, lower: 10 },
        { type: 'red',   height: 50,  upper: 10, lower: 10 },
        { type: 'green', height: 110, upper: 20, lower: 15 }
      ];


      for (let i = 0; i < numCandles; i++) {
        const candle = document.createElement('div');
        const pattern = candlePattern[i % candlePattern.length];
        
        let openPrice = clamp(currentClosePriceY, 0, chartHeight);
        const isGreen = pattern.type === 'green';
        const rawHeight = pattern.height;
        const upperWick = pattern.upper;
        const lowerWick = pattern.lower;

        let closePrice = clamp(
          openPrice + (isGreen ? rawHeight : -rawHeight), 
          0, 
          chartHeight
        );

        const finalHeight = Math.max(Math.abs(closePrice - openPrice), 1);
        const yPosition = Math.min(openPrice, closePrice);

        candle.className = 'candle ' + (isGreen ? 'green' : 'red');
        
        const xPosition = i * unitSpace;
        candle.style.left = `${xPosition}px`;
        candle.style.bottom = `${yPosition}px`;
        candle.style.height = `${finalHeight}px`;
        
        candle.style.setProperty('--upper-wick', `${upperWick}px`);
        candle.style.setProperty('--lower-wick', `${lowerWick}px`);

        const delay = i * delayPerCandle;
        candle.style.animationDelay = `${delay / 1000}s`;
        candle.style.animationDuration = `${delayPerCandle / 1000}s`;

        chart.appendChild(candle);
        currentClosePriceY = closePrice;
      }
    });
  </script>

  </head>

<body>
  <div id="loader">
    <div class="candles">
      </div>
    
    <div class="loader-bar-container">
      <div class="loader-bar-fill"></div>
    </div>
  </div>

  <script src="js/main.js" defer></script>
</body>
</html>